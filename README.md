# Онооны удирдлагын систем

Энэ систем нь оноог удирдах зориулалттай вэб суурилсан үйлчилгээ бөгөөд хэрэглэгчид Excel файл байршуулах замаар оноо олгох боломжтой. Бекэнд нь Node.js + MongoDB ашиглан өгөгдлийг хадгалах, удирдах үүрэгтэй бөгөөд фронтенд нь Excel өгөгдлийг боловсруулж сервер рүү илгээх үүрэгтэй.

**(Хэрэв та өөр мэдээллийн сан ашиглаж байгаа бол бидэнд мэдэгдэнэ үү. Бид уг мэдээллийн сантай тохирох кодын жишээг өгч чадна. Хэрэв та Node.js болон MongoDB-г ашиглаж байгаа бол одоогийн кодыг ашиглаж болно.)**

---

## 1. Үйлчилгээний бүрэлдэхүүн хэсгүүд

### Фронтенд (bulkUpload.js)
Фронтенд нь хэрэглэгчид Excel файлыг байршуулах болон сервер рүү өгөгдөл илгээх боломжийг дараах функцүүдээр хангадаг.

#### 1. Файл байршуулах процесс (handleFile)
- Хэрэглэгч файл байршуулах үед `handleFile()` функц ажиллана.
- `FileReader` ашиглан Excel файлыг уншиж, `XLSX.js`-ийг ашиглан JSON өгөгдөл болгон хувиргана.
- Excel баганын нэрс нь кодын хүлээгдэж буй утгатай (`userId`, `points`) таарч буй эсэхийг шалгана.

#### 2. Өгөгдлийн хүчинтэй байдлыг шалгах (validateExcelData)
- Байршуулсан өгөгдөлд хэрэглэгчийн ID тэмдэгт мөр эсэх, оноо тоон утга эсэхийг шалгана.
- Хэрэв утга хүчинтэй бус бол алдааны мэдэгдэл харуулж, байршуулах үйл явцыг зогсооно.

#### 3. Оноог боловсруулах (processPoints)
- Хүчинтэй өгөгдлийг боловсруулахдаа оноо нь сөрөг эсэхийг шалгана.
- Сөрөг оноо олгохыг зөвшөөрөхгүй бөгөөд анхааруулга харуулна.

#### 4. Сервер рүү өгөгдөл илгээх (sendToServer)
- `fetch()` ашиглан `/api/uploadPoints` маршрут руу JSON өгөгдлийг `POST` хүсэлтээр илгээнэ.
- Амжилттай боловсруулсны дараа хэрэглэгчид мэдэгдэл харуулна.

---

### Бекэнд (database.js)
Бекэнд нь байршуулсан онооны өгөгдлийг MongoDB-д хадгалж, удирддаг.

#### 1. Серверийн тохиргоо
- `Express` фреймворкийг ашиглан сервер үүсгэнэ.
- JSON хэлбэрийн өгөгдлийг боловсруулахын тулд `express.json()` middleware ашиглана.

#### 2. Мэдээллийн сангийн холболт
- `mongoose` ашиглан `mongodb://localhost:27017/pointsDB` хаягаар холбогдоно.
- `userId`, `points` талбартай `UserSchema` загвар үүсгэнэ.

#### 3. Оноо хадгалах API (/api/uploadPoints)
- Клиентээс ирсэн өгөгдлийг боловсруулна.
- Сөрөг оноог шүүж, зөвхөн хүчинтэй өгөгдлийг хадгална.
- Амжилттай бол хариу мэдэгдэл илгээнэ, алдаа гарвал статус код, алдааны мэдээлэл буцаана.

#### 4. Серверийг ажиллуулах
- Сервер нь `3000` портоор ажиллана, шаардлагатай бол тохируулан өөрчилж болно.

---

## 2. Үйл ажиллагааны ерөнхий явц

1. Админ хэрэглэгч Excel файл байршуулах.
2. Фронтенд нь Excel өгөгдлийг JSON болгон хувиргаж, шалгана.
3. Хүчинтэй өгөгдлийг сервер рүү илгээнэ.
4. Сервер нь өгөгдлийг хүлээн авч, MongoDB-д хадгална.
5. Хадгалагдсан онооны өгөгдлийг хэрэглэгчийн түвшинд харах, удирдах боломжтой.

---

## 3. Гол шалгалтууд болон хязгаарлалтууд

- **Онооны хүчинтэй байдлыг шалгах:**
  - Сөрөг оноог зөвшөөрөхгүй бөгөөд байршуулах үед шүүж устгана.
  
- **Excel баганын нэрийн шалгалт:**
  - Баганын нэрс `userId`, `points` байх ёстой. Хэрэв өөр байвал кодыг өөрчлөх шаардлагатай.

- **Серверийн портын тохиргоо:**
  - Анхдагч порт нь `3000` бөгөөд шаардлагатай бол өөрчилж болно.

---

## 4. Өргөтгөх боломжууд

- **Өөр мэдээллийн сан ашиглах:**
  - Одоогоор MongoDB-г ашиглаж байгаа боловч MySQL, PostgreSQL зэрэг рүү шилжүүлэх боломжтой.
  - Хүсэлтийн дагуу тохирох мэдээллийн сангийн кодын жишээг өгч болно.
